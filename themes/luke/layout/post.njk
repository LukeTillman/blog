{% extends "./_common/base.njk" %}

{# A macro for a social media icon button link #}
{% macro socialButton(href, icon, size, isColor) %}
  {# Figure out what classes to put on the button #}
  {% set buttonClass = icon %}
  {% if size !== 'normal' %}
    {% set buttonClass = buttonClass + ' is-' + size %}
  {% endif %}
  {% if isColor %}
    {% set buttonClass = buttonClass + ' is-color' %}
  {% endif %}

  <a href="{{ href }}" target="_blank" class="social-button {{ buttonClass }}">
    <span class="icon">
      <i class="fa fa-{{ icon }}"></i>
    </span>
  </a>
{% endmacro %}

{# A macro that outputs all the social media icon buttons #}
{% macro socialButtons(size = 'normal', isColor = false) %}
  {{ socialButton('https://twitter.com/LukeTillman', 'twitter', size, isColor) }}
  {{ socialButton('https://github.com/LukeTillman', 'github', size, isColor) }}
  {{ socialButton('/atom.xml', 'rss', size, isColor) }}
  {{ socialButton('https://plus.google.com/+LukeTillman1', 'google-plus', size, isColor) }}
  {{ socialButton('https://www.linkedin.com/in/luketillman', 'linkedin', size, isColor) }}
{% endmacro %}

{# Metadata for the head element #}
{% block head %}
<meta name="description" content="{{ page.excerpt }}" />
<meta name="keywords" content="{{ _.map(page.tags.data, 'name').join(',') }}" />
{% endblock %}

{# The main content block with the post #}
{% block content %}
<article class="post">
  {% set post = page %}
  {% include "./_common/post-header.njk" %}

  <div class="content post-content">
    {{ post.content | safe }}
  </div>

  {# Tags for the post #}
  <ul class="post-tags has-text-right">
    {% for t in post.tags.data %}
    <li class="post-tag">
      <a href="{{ url_for(t.path) }}" class="button is-light">{{ t.name }}</a>
    </li>
    {% endfor %}
  </ul>

  {# Author information #}
  <footer class="post-footer">
    <div class="media bio">
      <figure class="media-left">
        <p class="image is-128x128">
          <img src="{{ url_for(site.data.author.image_path) }}">
        </p>
      </figure>
      <div class="media-content">
        <h4 class="title is-4">
          {{ config.author }}
        </h4>
        <p class="bio-text">
          {{ site.data.author.bio }}
        </p>
        <p class="bio-text">
          {{ socialButtons('normal', true) }}
        </p>
      </div>
    </div>
  </footer>
</article>
{% endblock %}

{# The sidebar with the author bio #}
{% block sidebar %}
<aside class="sidebar bio">
  <p class="image is-128x128">
    <img src="{{ url_for(site.data.author.image_path) }}">
  </p>

  <h4 class="title is-4">
    {{ config.author }}
  </h4>

  <p class="bio-text">
    {{ socialButtons('small') }}
  </p>

  <p class="bio-text">
    {{ site.data.author.bio }}
  </p>
</aside>
{% endblock %}